<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æµ‹æµ‹ä½ æ˜¯ä¸æ˜¯çŒª</title>
  <!-- Tailwind CSS v3 -->
  <script src="https://cdn.tailwindcss.com"></script>

  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FFB6C1', // æµ…ç²‰è‰²
            secondary: '#F5F5F5', // æµ…ç°è‰²
            accent: '#FF69B4', // äº®ç²‰è‰²
          },
          fontFamily: {
            sans: ['Arial Rounded MT Bold', 'Avenir', 'Helvetica', 'Arial', 'sans-serif'],
          },
          animation: {
            'bounce-slow': 'bounce 2s infinite',
            'wiggle': 'wiggle 1s ease-in-out infinite',
            'pulse-slow': 'pulse 3s infinite',
          },
          keyframes: {
            wiggle: {
              '0%, 100%': { transform: 'rotate(-3deg)' },
              '50%': { transform: 'rotate(3deg)' },
            }
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .text-shadow-lg {
        text-shadow: 0 4px 8px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.08);
      }
      .progress-ring-circle {
        transition: stroke-dashoffset 0.35s;
        transform: rotate(-90deg);
        transform-origin: 50% 50%;
      }
    }
    
    body {
      touch-action: none; /* é˜²æ­¢é•¿æŒ‰å¼¹å‡ºèœå• */
      user-select: none; /* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
      -webkit-tap-highlight-color: transparent; /* ç§»é™¤ç‚¹å‡»é«˜äº® */
    }
    
    .result-card {
      transform-style: preserve-3d;
      transition: transform 0.6s;
    }
    
    .result-card.flipped {
      transform: rotateY(180deg);
    }
    
    .result-card-front, .result-card-back {
      backface-visibility: hidden;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    .result-card-back {
      transform: rotateY(180deg);
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    
    .progress-container {
      position: relative;
      width: 200px;
      height: 200px;
    }
    
    .progress-ring {
      transform: rotate(-90deg);
    }
    
    .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.5rem;
      font-weight: bold;
    }
    
    .press-hint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      pointer-events: none;
    }
  </style>
</head>
<body class="bg-secondary min-h-screen flex flex-col items-center justify-center p-4">
  <div class="container max-w-md mx-auto text-center">
    <!-- æ ‡é¢˜ -->
    <h1 class="text-4xl md:text-5xl font-bold mb-6 text-primary text-shadow-lg">
      æµ‹æµ‹ä½ æ˜¯ä¸æ˜¯çŒª <span class="text-accent">ğŸ·</span>
    </h1>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <div class="bg-white rounded-3xl shadow-lg p-6 mb-8 transform transition-all duration-300 hover:shadow-xl">
      <!-- æµ‹è¯•åŒºåŸŸ -->
      <div id="test-area" class="mb-6">
        <div class="progress-container mx-auto">
          <!-- åœ†å½¢è¿›åº¦æ¡ -->
          <svg class="progress-ring" width="200" height="200">
            <circle
              class="text-gray-200"
              stroke-width="10"
              stroke="currentColor"
              fill="transparent"
              r="85"
              cx="100"
              cy="100"
            />
            <circle
              id="progress-circle"
              class="text-primary progress-ring-circle"
              stroke-width="10"
              stroke="currentColor"
              fill="transparent"
              r="85"
              cx="100"
              cy="100"
              stroke-dasharray="534.07"
              stroke-dashoffset="534.07"
            />
          </svg>
          
          <!-- é•¿æŒ‰æç¤º -->
          <div id="press-hint" class="press-hint">
            <div class="text-5xl mb-2">ğŸ‘‡</div>
            <p class="text-lg text-gray-600">é•¿æŒ‰è¿™é‡Œæµ‹è¯•</p>
          </div>
          
          <!-- è¿›åº¦æ–‡æœ¬ -->
          <div id="progress-text" class="progress-text hidden">
            <span id="progress-percentage">0%</span>
          </div>
        </div>
        
        <!-- æç¤ºæ–‡å­— -->
        <p id="instruction" class="text-gray-600 mt-6">
          é•¿æŒ‰å±å¹•ä¸­é—´åŒºåŸŸï¼Œçœ‹çœ‹ä½ æ˜¯ä»€ä¹ˆçŒªï¼
        </p>
      </div>
      
      <!-- ç»“æœåŒºåŸŸ (åˆå§‹éšè—) -->
      <div id="result-area" class="hidden">
        <div class="bg-primary/10 rounded-2xl p-6 flex flex-col items-center justify-center h-64 mb-6">
          <div id="rarity-badge" class="px-3 py-1 rounded-full text-sm font-bold mb-3"></div>
          <img id="result-emoji" class="w-24 h-24 mb-4 float-animation" src="image/pig.png" alt="çŒª">
          <h2 id="result-title" class="text-2xl font-bold text-gray-800 mb-2">çŒª</h2>
          <p id="result-description" class="text-gray-600">
            ä½ æ˜¯ä¸€åªå¯çˆ±çš„å°çŒªçŒªï¼
          </p>
        </div>

        <button id="retest-button" class="bg-primary text-white py-2 px-6 rounded-full font-medium mb-4 hover:bg-primary/80 transition-colors">
          å†æµ‹ä¸€æ¬¡
        </button>

        <p class="text-gray-500 text-sm">
          æç¤ºï¼šé•¿æŒ‰è¶Šä¹…ï¼Œç¨€æœ‰åº¦è¶Šé«˜ï¼
        </p>
      </div>
    </div>
    
    <!-- é¡µè„š -->
    <footer class="text-gray-500 text-sm">
      <p>ä½œè€…ï¼šyjyRichard <span class="text-primary">ğŸ½</span></p>
    </footer>
  </div>

  <script>
    // ç»“æœæ•°æ®ï¼ˆå¸¦ç¨€æœ‰åº¦ï¼‰
    const pigResults = [
      { id: "human", name: "äººç±»", emoji: "ğŸ‘¤", description: "æ£€æµ‹ä¸å‡ºçŒªå…ƒç´ ï¼Œæ˜¯äººç±»å—ï¼Ÿ", rarity: "common" },
      { id: "pig", name: "çŒª", emoji: "ğŸ·", description: "æ™®é€šå°çŒª", rarity: "common" },
      { id: "black-pig", name: "å°é»‘çŒª", emoji: "ğŸ–", description: "å°é»‘çŒªï¼Œå¤å‡ºçŒªè„šäº†", rarity: "common" },
      { id: "wild-boar", name: "é‡çŒª", emoji: "ğŸ—", description: "ä½ æ˜¯ä¸€åªå‹‡çŒ›çš„é‡çŒªï¼", rarity: "common" },
      { id: "pig-human", name: "çŒªäºº", emoji: "ğŸ·ğŸ‘¤", description: "ä½ æ˜¯çŒªè¿˜æ˜¯äººï¼Ÿ", rarity: "common" },
      { id: "pig-cat", name: "çŒªå’ª", emoji: "ğŸ·ğŸ±", description: "ä½ æ˜¯ä¸€åªå¯çˆ±çš„çŒªå’ªï¼", rarity: "common" },
      { id: "zhuge-liang", name: "çŒªè‘›äº®", emoji: "ğŸ·ğŸ§ ", description: "çŒªé‡Œæœ€èªæ˜çš„ä¸€ä¸ª", rarity: "rare" },
      { id: "pig-stamp", name: "çŒªåœ†ç« ", emoji: "ğŸ·ğŸ”´", description: "ã€ŠçŒªåœˆé‚£äº›äº‹ã€‹", rarity: "rare" },
      { id: "zombie-pig", name: "åƒµå°¸çŒª", emoji: "ğŸ§ŸğŸ·", description: "å–œæ¬¢çš„é£Ÿç‰©æ˜¯çŒªè„‘", rarity: "rare" },
      { id: "skeleton-pig", name: "éª·é«…çŒª", emoji: "ğŸ’€ğŸ·", description: "èµ„æ·±ä¸æ­»æ—", rarity: "rare" },
      { id: "demon-pig", name: "æ¶é­”çŒª", emoji: "ğŸ˜ˆğŸ·", description: "æ»¡è‚šå­åå¿ƒçœ¼", rarity: "rare" },
      { id: "heaven-pig", name: "å¤©å ‚çŒª", emoji: "ğŸ˜‡ğŸ·", description: "ä¼¼äº†å–µ~", rarity: "rare" },
      { id: "explosive-pig", name: "çˆ†ç ´å°çŒª", emoji: "ğŸ’£ğŸ·", description: "æˆ‘è·Ÿä½ çˆ†äº†ï¼", rarity: "rare" },
      { id: "black-white-pig", name: "é»‘ç™½çŒª", emoji: "âš«âšªğŸ·", description: "ä¸²å­", rarity: "rare" },
      { id: "pork-skewer", name: "çŒªè‚‰ä¸²", emoji: "ğŸ¢", description: "çœŸæ­£çš„ä¸²å­", rarity: "rare" },
      { id: "magic-pig", name: "é­”æ³•å°‘çŒª", emoji: "ğŸª„ğŸ·", description: "é©¬çŒªçƒ§é…’", rarity: "epic" },
      { id: "mechanical-pig", name: "æœºæ¢°çŒª", emoji: "ğŸ¤–ğŸ·", description: "äººæœº", rarity: "epic" },
      { id: "pig-ball", name: "çŒªçŒªçƒ", emoji: "ğŸ€ğŸ·", description: "æ»šäº†", rarity: "epic" },
      { id: "doll-pig", name: "ç©å¶çŒª", emoji: "ğŸ§¸ğŸ·", description: "fufuå°çŒª", rarity: "epic" },
      { id: "soul-pig", name: "çµé­‚çŒª", emoji: "ğŸ‘»ğŸ·", description: "ä»å†¥ç•Œå½’æ¥çš„çŒª", rarity: "epic" },
      { id: "crystal-pig", name: "æ°´æ™¶çŒª", emoji: "ğŸ’ğŸ·", description: "çè´µåˆè„†å¼±çš„å°çŒª", rarity: "legendary" },
      { id: "snow-pig", name: "é›ªçŒª", emoji: "â„ï¸ğŸ·", description: "æ´ç™½çš„é›ªçŒª", rarity: "legendary" }
    ];

    const rarityConfig = {
      common: { label: "æ™®é€š", color: "#9CA3AF", weight: 60 },
      rare: { label: "ç¨€æœ‰", color: "#3B82F6", weight: 25 },
      epic: { label: "å²è¯—", color: "#A855F7", weight: 12 },
      legendary: { label: "ä¼ è¯´", color: "#F59E0B", weight: 3 }
    };

    // DOM å…ƒç´ 
    const testArea = document.getElementById('test-area');
    const resultArea = document.getElementById('result-area');
    const progressCircle = document.getElementById('progress-circle');
    const progressText = document.getElementById('progress-text');
    const progressPercentage = document.getElementById('progress-percentage');
    const pressHint = document.getElementById('press-hint');
    const instruction = document.getElementById('instruction');
    const resultEmoji = document.getElementById('result-emoji');
    const resultTitle = document.getElementById('result-title');
    const resultDescription = document.getElementById('result-description');
    const rarityBadge = document.getElementById('rarity-badge');
    const retestButton = document.getElementById('retest-button');
    
    // è¿›åº¦æ¡å‚æ•°
    const circumference = 2 * Math.PI * 85; // åœ†çš„å‘¨é•¿
    const requiredHoldTime = 3000; // é•¿æŒ‰æ‰€éœ€æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    let startTime = 0;
    let isHolding = false;
    let progressInterval;
    
    // åˆå§‹åŒ–è¿›åº¦æ¡
    progressCircle.style.strokeDasharray = `${circumference} ${circumference}`;
    progressCircle.style.strokeDashoffset = circumference;
    
    
    // é•¿æŒ‰å¼€å§‹äº‹ä»¶
    function handleHoldStart(e) {
      e.preventDefault();

      isHolding = true;
      startTime = Date.now();

      progressText.classList.remove('hidden');
      pressHint.classList.add('hidden');
      instruction.textContent = 'æ­£åœ¨æµ‹è¯•ä¸­...';

      progressInterval = setInterval(updateProgress, 30);

      testArea.classList.add('scale-105');
      testArea.style.transition = 'transform 0.2s';
    }
    
    // é•¿æŒ‰ç»“æŸäº‹ä»¶
    function handleHoldEnd() {
      isHolding = false;
      clearInterval(progressInterval);

      resetProgress();

      testArea.classList.remove('scale-105');
      instruction.textContent = 'å°†æ‰‹æŒ‡æ”¾åˆ°å±å¹•ä¸­é—´åŒºåŸŸï¼Œé•¿æŒ‰æ±²å–çŒªå…ƒç´ ';
    }
    
    // æ›´æ–°è¿›åº¦æ¡
    function updateProgress() {
      if (!isHolding) return;
      
      const elapsedTime = Date.now() - startTime;
      const progress = Math.min(elapsedTime / requiredHoldTime, 1);
      const offset = circumference - (progress * circumference);
      
      // æ›´æ–°è¿›åº¦æ¡
      progressCircle.style.strokeDashoffset = offset;
      
      // æ›´æ–°ç™¾åˆ†æ¯”æ–‡æœ¬
      const percentage = Math.round(progress * 100);
      progressPercentage.textContent = `${percentage}%`;
      
      // å¦‚æœè¾¾åˆ°100%ï¼Œç”Ÿæˆç»“æœ
      if (progress >= 1) {
        clearInterval(progressInterval);
        generateResult();
      }
    }
    
    // é‡ç½®è¿›åº¦æ¡
    function resetProgress() {
      clearInterval(progressInterval);
      progressCircle.style.strokeDashoffset = circumference;
      progressText.classList.add('hidden');
      pressHint.classList.remove('hidden');
      progressPercentage.textContent = '0%';
    }
    
    // ç”Ÿæˆéšæœºç»“æœï¼ˆåŸºäºç¨€æœ‰åº¦æƒé‡ï¼‰
    function generateResult() {
      playSound('complete');

      const elapsedTime = Date.now() - startTime;
      const holdBonus = Math.min((elapsedTime - requiredHoldTime) / 2000, 2);

      const weights = [];
      pigResults.forEach(pig => {
        let weight = rarityConfig[pig.rarity].weight;
        if (pig.rarity !== 'common') weight += holdBonus * 0.8;
        weights.push(weight);
      });

      const totalWeight = weights.reduce((a, b) => a + b, 0);
      let random = Math.random() * totalWeight;

      let result = pigResults[0];
      for (let i = 0; i < pigResults.length; i++) {
        random -= weights[i];
        if (random <= 0) {
          result = pigResults[i];
          break;
        }
      }

      showResult(result);
    }
    
    // æ˜¾ç¤ºç»“æœ
    function showResult(result) {
      testArea.classList.add('hidden');
      resultArea.classList.remove('hidden');

      const rarity = rarityConfig[result.rarity];
      rarityBadge.textContent = rarity.label;
      rarityBadge.style.backgroundColor = rarity.color;
      rarityBadge.style.color = 'white';

      const imageSrc = `image/${result.id}.png`;
      resultEmoji.src = imageSrc;
      resultEmoji.alt = result.name;
      resultTitle.textContent = result.name;
      resultDescription.textContent = result.description;

      resultEmoji.onerror = function() {
        resultEmoji.src = 'image/pig.png';
      };

      resultArea.style.opacity = '0';
      resultArea.style.transform = 'translateY(20px)';
      resultArea.style.transition = 'opacity 0.5s, transform 0.5s';

      setTimeout(() => {
        resultArea.style.opacity = '1';
        resultArea.style.transform = 'translateY(0)';
      }, 10);
    }
    
    // æ’­æ”¾éŸ³æ•ˆ
    function playSound(type) {
      try {
        // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();
        
        // åˆ›å»ºæŒ¯è¡å™¨
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        
        // è®¾ç½®éŸ³æ•ˆå‚æ•°
        if (type === 'complete') {
          oscillator.type = 'sine';
          oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
          oscillator.frequency.setValueAtTime(659.25, audioCtx.currentTime + 0.1); // E5
          oscillator.frequency.setValueAtTime(783.99, audioCtx.currentTime + 0.2); // G5
          
          gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
          
          oscillator.start(audioCtx.currentTime);
          oscillator.stop(audioCtx.currentTime + 0.3);
        }
      } catch (error) {
        console.error('æ’­æ”¾éŸ³æ•ˆå¤±è´¥:', error);
        // éŸ³æ•ˆæ’­æ”¾å¤±è´¥ä¸å½±å“ä¸»è¦åŠŸèƒ½
      }
    }
    


    // é‡æ–°æµ‹è¯•å‡½æ•°
    function handleRetest() {
      resetProgress();
      testArea.classList.remove('hidden');
      resultArea.classList.add('hidden');
      instruction.textContent = 'é•¿æŒ‰å±å¹•ä¸­é—´åŒºåŸŸï¼Œçœ‹çœ‹ä½ æ˜¯ä»€ä¹ˆçŒªï¼';
    }
    
    // è§¦æ‘¸äº‹ä»¶ç›‘å¬
    const progressContainer = document.querySelector('.progress-container');

    if (progressContainer) {
      progressContainer.addEventListener('mousedown', handleHoldStart);
      progressContainer.addEventListener('touchstart', handleHoldStart);
    }

    document.addEventListener('mouseup', handleHoldEnd);
    document.addEventListener('touchend', handleHoldEnd);
    document.addEventListener('touchcancel', handleHoldEnd);

    retestButton.addEventListener('click', handleRetest);
  </script>
</body>
</html>